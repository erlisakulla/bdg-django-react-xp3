
# BACKEND README


## Software Requirements
Install Python and Pip before working on the Backend.
Python 3.8.8 64-bit, pip 20.2.3 was used while creating this Backend Project.

## Installation
Follow the steps mentioned below after Python and Pip Installation.
### NOTE
If you are reading this documentation. It is assumed that you are already inside the backend directory of the project and has already cloned the repository. If not goto home directory of this repo and read the readme documentation.

Inside backend directory ,run 
```bash
pip install virtualenv
```
for installing virtualenv package which will be used for isolating the packages used for this project. 
We recommend that you should create a virtual environment before working on this backend project.

```bash
virtualenv venv
```
'venv' can be replaced according to your preference.


You can activate the python environment by running the following command:
Mac OS / Linux
```bash
source venv/bin/activate
```
Windows
```shell
venv\Scripts\activate
```
You should activate the venv again if you comeback later or open new tab on the terminal.

After activating the virtual-environment, please run the following commands.

```bash
pip install -r requirements.txt
```
'requirements.txt' contains all the pip packages required for this project to work properly. This file contains
```
django
djangorestframework
django-cors-headers
djangorestframework_simplejwt
drf-yasg
```

Once successful, run  the migration commands to create migrations files and migrate the Models to the database.
```
python manage.py makemigrations
python manage.py migrate
```
You must run the above commands every time you do any changes in the models like adding a property, and needs to be updated in the database.

This project may contain database file already and If you want a fresh install delete migrations folder inside api module and db.sqlite3 file and run (optional)
```
python manage.py makemigrations api
python manage.py migrate
```
If you completely remove the folder related to migrations then you have to mention the app name as shown above to install the migrations properly otherwise simply remove the files only not the migrations module folder.

### Starting the Server
```
python manage.py runserver
```
### To create a new-app 
```
python manage.py startapp
```

### Running Tests
```
python manage.py test
```
runs all the test cases from tests module and functions with `test_` as a prefix

## Documentation

###  Backend  
All the autogenerated html files containing function/class definitions  can be found inside [backend/docs/_build/html/](https://github.com/lorenzorota/se-03-team-32/tree/main/backend/docs/_build/html/) and the entry point is `index.html`. (Recently Introduced, may not cover all the function definitions but should be enough to get the general idea)

If you would like to contribute to this documentation method, Install sphinx tool. (optional)

```
pip install -U sphinx
```
```
cd docs
make html
```

Reference  : (https://www.sphinx-doc.org/en/master/)

### API Documentation
Everything is automated using djangorestframework yet another swagger generator. 
To view all available endpoints , Goto`http://localhost:8000/swagger/` or  `http://localhost:8000/redoc/` after starting the backend server.

If you want to add a description to what your endpoints does simply add 
```
from drf_yasg.utils import swagger_auto_schema

@swagger_auto_schema(operation_description="partial_update description override", responses={404: 'slug not found'})
def partial_update(self, request, *args, **kwargs):
   """partial_update method docstring"""
   ...
```
just before your function as shown above.

Reference: (https://drf-yasg.readthedocs.io/en/stable/)


## PROJECT FILE STRUCTURE
```
    beergame
    ├── api
    │   ├── __init__.py
    │   ├── admin.py          # To register models on admin panel.
    │   ├── apps.py
    │   ├── migrations        # Migration files for database(automated) 
    │   ├── models.py         # Contains all Models User,Game,Role,Week.
    │   ├── serializers.py   # Serializers for models ( for validation/model output)
    │   ├── tests             # Contains all the testing codes
    │   │   ├── __init__.py
    │   │   ├── tests_api_game.py
    │   │   ├── tests_api_roles.py
    │   │   ├── tests_api_user.py
    │   │   └── tests_model.py
    │   └── views                # All endpoints related codes
    │       ├── __init__.py
    │       ├── game.py
    │       ├── role.py
    │       └── user.py
    ├── beergameapi.  #Project Module 
    │   ├── __init__.py
    │   ├── asgi.py
    │   ├── settings.py  #Config files for tokens, CORS, registering apps.
    │   ├── urls.py    #Contains ulrs + router for handling routes
    │   └── wsgi.py
    ├── db.sqlite3        #Database File
    ├── manage.py      # Use this to run commands like runserver, makemigrations
    ├── readme.md
    └── requirements.txt  #Contains requiredpackages

```


## References
1. [Django Documentation](https://docs.djangoproject.com/en/3.2/)
Django was used in this project because it contains all the necessary features like Admin, Models, URL routing to get you started quickly.
2. [djangorestframework Quicstart](https://www.django-rest-framework.org/tutorial/quickstart/)
Offers cleaner and efficient Class,Function based views with serialisers to convert your Models into API.

3. [django-cors-headers](https://pypi.org/project/django-cors-headers/) 
Cross-origin resource sharing. Necessary to allow frontend communicate and request data from the backend.
4. [djangorestframework_simplejwt](https://django-rest-framework-simplejwt.readthedocs.io/en/latest/) - WebTokens
Fits well with djangorestframeworks and useful for handling tokens as session is not a thing if you separate frontend and backend to different servers.
5. [drf-yasg](https://drf-yasg.readthedocs.io/en/stable/readme.html) 
  Yet another Swagger generator - API Playground/ Generates automatic documentation for all views compatible with djangorestframework
